<!--

    Copyright © 2012 ecuacion.jp (info@ecuacion.jp)

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8" />
</head>
<body>

	<!--/* 
		###
		### base-page components (components available in any pages)
		###
	 */-->
	 
	<!--/* 
		### common components
	 */-->
	 
	<!--/* internalAllCommonComponent */-->
	<!--/* 
		 * Is a common part of components which stores common variables obtained from options.
		 = It doesn't contain any main components.
		 */-->
	<!--/* parameters:
		- contentsOfAllCommon		is a fragment which contains main contents.	
		- createsComponentIdDiv		If it's true, <div th:id="${componentId}"> is created. 
		  							If it's false (=you don't want to add 'id' attribute to div component), caller component need to implement component as id = ${componentId}. 
	 */-->
	<!--/* options:
		- componentId	Specifies 'id' attribute of the whole integrated component. 
						As default id value is the same as the value of name for html controls.
		- mt			Specifies the margin top value of the integrated component. 
						When you set 'mt=3' to options, it turns into 'class="mt-3"'. It's valid only when createsComponentIdDiv == true.
						It's implemented in addition to classappend because it's appended not to the main component, but to the most outside tag. 
		- mb			Specifies the margin bottom value of the integrated component.
						When you set 'mb=3' to options, it turns into 'class="mb-3"'. It's valid only when createsComponentIdDiv == true.
						It's implemented in addition to classappend because it's appended not to the main component, but to the most outside tag. 
		- classappend   Appends designated class to main component.
		                Multiple designation allowed like 'class=cls1,class=cls2'. 
		- attr			Is used for th:attr. Set like 'attr=key1|value1'. 10 attrs tops.
						This has 10 attrs, but each component does not need to have all 10 attrs because it's usually too much.
		- event			Specifies javascript event. It's designated by event name and the function called by it separated by '|',
		                like 'event=click|func'. 
		                'event name' and 'function' is used in 'addEventListener'.
		                Multiple events can be used. 'event=click|func1,event=click|func2' calls func1 and func2 in this order.
 	 */-->
	<div th:fragment="internalAllCommonComponent(contentsOfAllCommon, createsComponentIdDiv, options)" th:remove="tag">
		<th:block th:with="
				componentId=${@optUtil.getValueOrElse(options, 'componentId', null)}
				,mtClass=${@optUtil.hasKey(options, 'mt') ? 'mt-' + @optUtil.getValue(options, 'mt') : ''}
				,mbClass=${@optUtil.hasKey(options, 'mb') ? 'mb-' + @optUtil.getValue(options, 'mb') : ''}
				,classappend=' ' + ${@optUtil.getValuesInSpaceSeparetedFormat(options, 'classappend')}
				,attr1Key=${@optUtil.getElementFromValuesOfPsvOrElse(options, 'attr', 0, 0, 'attr1')}, attr1Value=${@optUtil.getElementFromValuesOfPsv(options, 'attr', 0, 1)}
				,attr2Key=${@optUtil.getElementFromValuesOfPsvOrElse(options, 'attr', 1, 0, 'attr2')}, attr2Value=${@optUtil.getElementFromValuesOfPsv(options, 'attr', 1, 1)}
				,attr3Key=${@optUtil.getElementFromValuesOfPsvOrElse(options, 'attr', 2, 0, 'attr3')}, attr3Value=${@optUtil.getElementFromValuesOfPsv(options, 'attr', 2, 1)}
				,attr4Key=${@optUtil.getElementFromValuesOfPsvOrElse(options, 'attr', 3, 0, 'attr4')}, attr4Value=${@optUtil.getElementFromValuesOfPsv(options, 'attr', 3, 1)}
				,attr5Key=${@optUtil.getElementFromValuesOfPsvOrElse(options, 'attr', 4, 0, 'attr5')}, attr5Value=${@optUtil.getElementFromValuesOfPsv(options, 'attr', 4, 1)}
				,attr6Key=${@optUtil.getElementFromValuesOfPsvOrElse(options, 'attr', 5, 0, 'attr6')}, attr6Value=${@optUtil.getElementFromValuesOfPsv(options, 'attr', 5, 1)}
				,attr7Key=${@optUtil.getElementFromValuesOfPsvOrElse(options, 'attr', 6, 0, 'attr7')}, attr7Value=${@optUtil.getElementFromValuesOfPsv(options, 'attr', 6, 1)}
				,attr8Key=${@optUtil.getElementFromValuesOfPsvOrElse(options, 'attr', 7, 0, 'attr8')}, attr8Value=${@optUtil.getElementFromValuesOfPsv(options, 'attr', 7, 1)}
				,attr9Key=${@optUtil.getElementFromValuesOfPsvOrElse(options, 'attr', 8, 0, 'attr9')}, attr9Value=${@optUtil.getElementFromValuesOfPsv(options, 'attr', 8, 1)}
				,attr10Key=${@optUtil.getElementFromValuesOfPsvOrElse(options, 'attr', 9, 0, 'attr10')}, attr10Value=${@optUtil.getElementFromValuesOfPsv(options, 'attr', 9, 1)}
				">

			<!--/* maximux number of attr check */-->				
			<th:block th:if="${@optUtil.getValues(options, 'attr').length > 10}">
				[[${@exUtil.systemError('Maximum number of option: attr is 10.')}]]
			</th:block>
			
			<div th:if="${createsComponentIdDiv}" th:id="${componentId}" th:classappend="${mtClass} + ' ' + ${mbClass}">
				<th:block th:replace="${contentsOfAllCommon}" />
			</div>
			<th:block th:if="${!createsComponentIdDiv}">
				<th:block th:replace="${contentsOfAllCommon}" />
			</th:block>
			
			<th:block th:if="${@optUtil.hasKey(options, 'event')}" th:each="event : ${@optUtil.getValues(options, 'event')}">
				<script th:inline="javascript" th:with="eventKind=${#strings.arraySplit(event, '|')[0]}, func=${#strings.arraySplit(event, '|')[1]}">
					document.getElementById('[(${id})]').addEventListener(/*[[${eventKind}]]*/ 'click',  
							(e) => window[ /*[[${func}]]*/ 'func'](e, document.getElementById('[(${id})]')));
				</script>
			</th:block>
			
		</th:block>
	</div>
	
	<!--/* fragment with no contents. Used as 'null' fragment since you can't pass null to fragment parameters. */-->
	<div th:fragment="nullFragment" th:remove="tag">
	</div>

	<!--/* 
		### message components
	 */-->

	<!--/* internal common display message component */-->
	<!--/* 
		'title' and 'message' can be the key to the message.properties or item_names.properties, 
		or if it does not exist in properties files, it shows the string directly.
	*/-->
	<!--/* options:
		- selectable	boolean	Specifies whether it looks selectable on hover. Notice that this option make components look like selectable only.
						Procedure on click needs to be added aside this option.
						This options is meant to be a message components common option, but for now it's implemented only in speechBaloon.
 	 */-->
 	<div th:fragment="internalMessageCommonComponent(contents, options)" th:remove="tag">
 		<div th:replace="~{ :: internalAllCommonComponent(~{ :: fragmentMessageCommonComponent}, true, ${options})}"></div>
 		
		<th:block th:if="false"><div th:fragment="fragmentMessageCommonComponent" th:remove="tag">
			<div class="text-dark" 
					th:with="titleString=${@msgUtil.getValue(#locale, title)},
					messageString=${@msgUtil.getValue(#locale, message)},
					isSelectable=${@optUtil.hasKey(options, 'selectable')}">

				<th:block th:replace="${contents}" />

			</div>
		</div>
	</div>

	<!--/* title */-->
	<div th:fragment="title(title, options)" th:remove="tag">
 		<div th:replace="~{ :: internalMessageCommonComponent(~{ :: titleInternal}, ${'mt=3,mb=5,' + options})}"></div>

		<th:block th:if="false"><div th:fragment="titleInternal" th:remove="tag">
			<div class="fs-3 fw-bold" th:text="${titleString}"></div>
		</div></th:block>
	</div>

	<!--/* subtitle  */-->
	<div th:fragment="subtitle(title, options)" th:remove="tag">
 		<div th:replace="~{ :: internalMessageCommonComponent(~{ :: subtitleInternal}, ${'mt=5,mb=3,' + options})}"></div>

		<th:block th:if="false"><div th:fragment="subtitleInternal" th:remove="tag">
			<div class="border-5 border-color-subtitle fs-5 fw-bold pt-1 pb-1 ps-3" style="border-left: solid;" th:text="${titleString}"></div>
		</div></th:block>
	</div>

	<!--/* paragraphWithSubtitle */-->
	<div th:fragment="paragraphWithSubtitle(title, message, options)" th:remove="tag">
 		<div th:replace="~{ :: internalMessageCommonComponent(~{ :: paragraphWithSubtitleInternal}, ${'mt=5,mb=3,' + options})}"></div>

		<th:block th:if="false"><div th:fragment="paragraphWithSubtitleInternal" th:remove="tag">
 			<div th:replace="~{ :: subtitleInternal}"></div>
			<div class="mt-3" style="white-space: pre-wrap;" th:text="${messageString}"></div>
		</div></th:block>
	</div>
	
	<!--/* subsubtitle  */-->
	<div th:fragment="subsubtitle(title, options)" th:remove="tag">
		<div th:replace="~{ :: internalMessageCommonComponent(~{ :: subsubtitleInternal}, ${'mt=5,mb=3,' + options})}"></div>

		<th:block th:if="false"><div th:fragment="subsubtitleInternal" th:remove="tag">
			<div>
				<div class="pt-1 pb-1 ps-3">
					<span class="text-color-subtitle me-3 fs-7 fw-bold">&#45;</span><span class="fs-5 fw-bold" th:text="${titleString}"></span>
				</div>
			</div>
		</div></th:block>
	</div>

	<!--/* paragraphWithSubsubtitle */-->
	<div th:fragment="paragraphWithSubsubtitle(title, message, options)" th:remove="tag">
 		<div th:replace="~{ :: internalMessageCommonComponent(~{ :: paragraphWithSubsubtitleInternal}, ${'mb=3,' + options})}"></div>

		<th:block th:if="false"><div th:fragment="paragraphWithSubsubtitleInternal" th:remove="tag">
 			<div th:replace="~{ :: subsubtitleInternal}"></div>
			<div class="mt-3" style="white-space: pre-wrap;" th:text="${messageString}"></div>
		</div></th:block>
	</div>
	
	<!--/* paragraph */-->
	<div th:fragment="paragraph(message, options)" th:remove="tag">
 		<div th:replace="~{ :: internalMessageCommonComponent(~{ :: paragraphInternal}, ${'mt=3,' + options})}"></div>

		<th:block th:if="false"><div th:fragment="paragraphInternal" th:remove="tag">
			<div class="" style="white-space: pre-wrap;" th:text="${messageString}"></div>
		</div></th:block>
	</div>
	
	<!--/* referenceBox */-->
	<div th:fragment="referenceBox(title, message, options)" th:remove="tag">
 		<div th:replace="~{ :: internalMessageCommonComponent(~{ :: referenceBoxInternal}, ${'mt=4,' + options})}"></div>

		<th:block th:if="false"><div th:fragment="referenceBoxInternal" th:remove="tag">
			<th:block th:if="${!#strings.isEmpty(titleString)}"><code class="text-dark" th:text="'[' + ${titleString} + ']'"></code></th:block>
			<div class="border ps-3 pe-3" style="background-color: #ffffe0">
				<pre class="mb-0"><code><div class="mt-3 mb-3" style="white-space: pre-wrap;" th:text="${messageString}"></div></code></pre>
			</div>
		</div></th:block>
	</div>

	<!--/* box. space enclosed by a frame. */-->
	<div th:fragment="box(boxContents, title, message, options)" th:remove="tag">
 		<div th:replace="~{ :: internalMessageCommonComponent(~{ :: boxInternal}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="boxInternal" th:remove="tag">
			<div class="border mt-3">
				<div class="m-3">
					<th:block th:if="${!#strings.isEmpty(titleString)}">
						<div class="fs-4 mb-3" th:text="${titleString}"></div>
					</th:block>
					<th:block th:if="${!#strings.isEmpty(messageString)}">
						<div class="mb-3" style="white-space: pre-wrap;" th:text="${messageString}"></div>
					</th:block>

					<th:block th:replace="${boxContents}" />

				</div>
			</div>
		</div></th:block>
	</div>
	
	<!--/* freeSpace */-->
	<!--/* You can input free text / html. It is used for commonize color and font. */-->
	<div th:fragment="freeSpace(freeSpaceContent, options)" th:remove="tag">
 		<div th:replace="~{ :: internalMessageCommonComponent(~{ :: freeSpaceInternal}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="freeSpaceInternal" th:remove="tag">
				<th:block th:replace="${freeSpaceContent}" />
		</div></th:block>
	</div>
	
	<!--/* speech balloon: chat style message component. */-->
	<!--/* 
		special thanks to: https://stand-4u.com/css/fukidashi.html
	 */-->
	<div  th:fragment="speechBalloon(message, isMyMessage, name, timestamp, options)" th:remove="tag">
 		<div th:replace="~{ :: internalMessageCommonComponent(~{ :: fragmentSpeechBalloon}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentSpeechBalloon" th:remove="tag">
			<!--/* Add space character when the input string is blank. */-->
			<div th:classappend="'balloon_' + ${isMyMessage ? 'r' : 'l'}" th:with="message=${message == null || message == '' ? '&nbsp;' : message}">
				<div class="faceicon" th:if="${!isMyMessage}">
					<img th:src="@{/images/speech-balloon-account-icon.png}" alt="" />
				</div>
				<div>
					<div class="name" th:if="${!isMyMessage}" th:text="${name}"></div>
					<div th:classappend="${'says' + (isSelectable ? '-selectable' : '')}" th:text="${messageString}"></div>
					<div class="name mt-1" th:style="${'font-size: 60%; ' + (isMyMessage ? '' : 'display: flex; align-items: flex-end;')}">
					<span th:style="${isMyMessage ? 'margin-left: auto;' : ''}" th:text="${timestamp}"></span>
				</div>
			</div>
		</div></th:block>
	</div>
	
	<!--/* 
		### table components.
	 */-->

	<!--/* internal common table component */-->
	<!--/* 
		'title' and 'message' can be the key to the message.properties or item_names.properties, 
		or if it does not exist in properties files, it shows the string directly.
	*/-->
	<div th:fragment="internalTableCommonComponent(contents, options)" th:remove="tag">
 		<div th:replace="~{ :: internalAllCommonComponent(~{ :: fragmentTableCommonComponent}, false, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentTableCommonComponent" th:remove="tag">
			<th:block th:replace="${contents}" />
		</div></th:block>
	</div>

	<!--/* internalStaticTableCell */-->
	<!--/* parameters:
		- cellElement		multiple types	an array which consists of attributes of a cell. The array can be one of the following formats:
											1. string                   (just a string)
											2. ${ {string} }            (an array with one attribute)
											3. ${ {string, options} }   (an array with two attributes)
		- isHeader			boolean			Specifies whether the cell is placed in the header line or not.
		- cascadedOptions	string			options set for line or the head / body part of the table.
											The options for cell is prior to it, but when the value is not set at the option for cell, 
											the value of cascadedOptions is used.
	 */-->
	<!--/* options: (in the cellELement)
		- rowspan			integer	Specifies the rowspan value. default value is 1.
		- colspan			integer	Specifies the colspan value. default value is 1.
		- textAlignment		string	Specifies the text-alignment. It takes either start, end, center.
		- textColor			string	Specifies the color attribute.
		- backgroundColor	string	Specifies the background-color attribute.
		- utext				(none)	Specifies the string is unescaped. No value need to be specified.
 	 */-->
	<div th:fragment="internalStaticTableCell(cellElement, isHeader, cascadedOptions)" th:remove="tag">
		<th:block th:with="
				string=${cellElement.class.name == 'java.lang.String' ? cellElement : cellElement[0]},
				options=${cascadedOptions + ',' + ((cellElement.class.name == 'java.lang.String' || #lists.size(cellElement)== 1) ? '' : cellElement[1])}">
			<th:block th:with="
					textColor=${@optUtil.getValueOrElse(options, 'textColor', '')},
					textColorStyle=${textColor == '' ? '' : 'color: ' + textColor + '; '},
					bgColor=${@optUtil.getValueOrElse(options, 'backgroundColor', '')},
					bgColorStyle=${bgColor == '' ? '' : 'background-color: ' + bgColor + '; '},
					class=${'align-middle fs-6'},
					text=${@msgUtil.getValue(#locale, string)},
					isUtext=${@optUtil.hasKey(options, 'utext') ? true : false},
					textAlignment=${'text-' + @optUtil.getValueOrElse(options, 'textAlignment', isHeader ? 'center' : 'left')},
					style=${'white-space: pre-wrap; ' + textColorStyle + bgColorStyle},
					rowspan=${@optUtil.getValueOrElse(options, 'rowspan', 1)},
					colspan=${@optUtil.getValueOrElse(options, 'colspan', 1)},
					">

				<th:block th:if="${isHeader}" th:with="thClass=${class + ' text-white bg-color-tbl-header' + ' ' + (bsBgGradient ? 'bg-gradient' : '') + ' ' + textAlignment}">
					<th:block th:if="${isUtext}">
						<th th:class="${thClass}" th:style="${style}" th:rowspan="${rowspan}" th:colspan="${colspan}" th:utext="${text}"></th>
					</th:block>
					<th:block th:if="${!isUtext}">
						<th th:class="${thClass}" th:style="${style}" th:rowspan="${rowspan}" th:colspan="${colspan}" th:text="${text}"></th>
					</th:block>
				</th:block>

				<th:block th:if="${!isHeader}" th:with="tdClass=${class + ' ' + textAlignment}">
					<th:block th:if="${isUtext}">
						<td th:class="${tdClass}" th:style="${style}" th:rowspan="${rowspan}" th:colspan="${colspan}" th:utext="${text}"></td>
					</th:block>
					<th:block th:if="${!isUtext}">
						<td th:class="${tdClass}" th:style="${style}" th:rowspan="${rowspan}" th:colspan="${colspan}" th:text="${text}"></td>
					</th:block>
				</th:block>
			</th:block>
		</th:block>
	</div>

	<!--/* internalStaticTableLine */-->
	<!--/* parameters:
		- cellElements		array	an array of "cellElement"s. See parameters part of "internalStaticTableCell" for the format of each cellElement.
									The array can be { cellElement, ..., } or { cellElement, ..., lineOptions }.
									"lineOptions" is a format of the same as that of cellElement, { null, options }. 1st element must be null.
									lineOptions is a string parameter, which is cascaded to cellElement options.		
		- cascadedOptions	string	options cascaded from the upper component.
	 */-->
 	<div th:fragment="internalStaticTableLine(cellElementsFor1Line, isHeader, cascadedOptions)" th:remove="tag">
		<th:block th:with="arrayLength=${#lists.size(cellElementsFor1Line)}, 
				containsOptionsInLine=${cellElementsFor1Line[arrayLength - 1].class.name.contains('Collection') and cellElementsFor1Line[arrayLength - 1][0] == null}, 
				optionsInLine=${containsOptionsInLine ? cellElementsFor1Line[arrayLength - 1][1] : ''}, options=${cascadedOptions + ',' + optionsInLine}">
			<th:block th:with="arrayLength=${containsOptionsInLine ? arrayLength - 1 : arrayLength}">
				<tr>
					<th:block th:each="cellElement, loopStatus : ${cellElementsFor1Line}">
						<th:block th:if="${loopStatus.index < arrayLength}">
							<div th:replace="~{ :: internalStaticTableCell(${cellElement}, ${isHeader}, ${cascadedOptions + ',' + options})}"></div>
						</th:block>
					</th:block>
				</tr>
			</th:block>
		</th:block>
	</div>
		
	<!--/* static table lines from lines of cell elements */-->
	<div th:fragment="internalStaticTableLines(lines, isHeader, cascadedOptions)" th:remove="tag">
		<div th:replace="~{ :: internalTableCommonComponent(~{ :: fragmentinternalStaticTableLines}, ${cascadedOptions})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentinternalStaticTableLines" th:remove="tag">
			<th:block th:with="containsOptionsInLines=${lines[#lists.size(lines) - 1].class.name.contains('String')}, 
					optionsInLines=${containsOptionsInLines ? lines[#lists.size(lines) - 1] : ''}, options=${cascadedOptions + ',' + optionsInLines}">
				<th:block th:each="cellElementsFor1Line, loopStatus : ${lines}">
					<th:block th:if="${!containsOptionsInLines or loopStatus.index != #lists.size(lines) - 1}">
						<div th:replace="~{ :: internalStaticTableLine(${cellElementsFor1Line}, ${isHeader}, ${options})}"></div>
					</th:block>
				</th:block>
			</th:block>
		</div></th:block>
	</div>
	
	<!--/* static table header */-->
	<!--/* 
		The parameter labels is an array of strings.
		It's supposed to define as "${ {'messageId_1', 'messageId_2', 'messageId_3'} }".
	 */-->
	<div th:fragment="staticTableHeaderWithLine(cellElements, options)" th:remove="tag">
 		<div th:replace="~{ :: internalTableCommonComponent(~{ :: fragmentStaticTableHeaderWithLine}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentStaticTableHeaderWithLine" th:remove="tag">
			<thead th:id="${componentId}">
				<div th:replace="~{ :: internalStaticTableLine(${cellElements}, true, ${options})}"></div>
			</thead>
		</div></th:block>
	</div>
	
	<div th:fragment="staticTableHeaderWithLines(headerLines, options)" th:remove="tag">
 		<div th:replace="~{ :: internalTableCommonComponent(~{ :: fragmentStaticTableHeaderWithLines}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentStaticTableHeaderWithLines" th:remove="tag">
			<thead th:id="${componentId}">
				<div th:replace="~{ :: internalStaticTableLines(${headerLines}, true, ${options})}"></div>
			</thead>
		</div></th:block>
	</div>
	<!--/* static table body from lines of cell elements. */-->
	<!--/*
		Each cellElement in a table is expressed in the form of an array :  {alignment, string} or {alignment, string, rowspan, colspan}
		where alignment selections are 'start', 'center' and 'end'.
		cellElements (= cell elements which form a line of a table) is an array of 'cellElement's, which means cellElements is a 2-dimensional array.
		linesOfCellElements is an array of cellElements, which means linesOfCellElements is 3-dimensional array.
	 */-->
	<div th:fragment="staticTableBodyWithLines(linesOfCellElements, options)" th:remove="tag">
		<div th:replace="~{ :: internalTableCommonComponent(~{ :: fragmentstaticTableBodyWithLines}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentstaticTableBodyWithLines" th:remove="tag">
			<tbody th:id="${componentId}" style="--bs-table-bg: transparent;">
				<div th:replace="~{ :: internalStaticTableLines(${linesOfCellElements}, false, ${options})}"></div>
			</tbody>
		</div></th:block>
 	</div>
	
	<!--/* static table body from an array of lines of cell elements. */-->
	<!--/* 
		staticTableBodyWithLines creates table from one 'linesOCellElements', 
		but sometimes you want to create a table from multiple 'linesOfCellElements', 
		for example table lines have a common part. 
	 */-->
	<div th:fragment="staticTableBodyWithArrayOfLines(arrayOfLinesOfCellElements, options)" th:remove="tag">
		<div th:replace="~{ :: internalTableCommonComponent(~{ :: fragmentStaticTableBodyWithArrayOfLines}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentStaticTableBodyWithArrayOfLines" th:remove="tag">
			<tbody th:id="${componentId}" style="--bs-table-bg: transparent;">
				<th:block th:each="linesOfCellElements : ${arrayOfLinesOfCellElements}">
					<div th:replace="~{ :: internalStaticTableLines(${linesOfCellElements}, false, ${options})}"></div>
				</th:block>
			</tbody>
		</div></th:block>
 	</div>

	<!--/* 
		### shape components.
	 */-->
	
	<!--/* hr */-->
	<div th:fragment=horizontalLine(options) th:remove="tag">
 		<div th:replace="~{ :: internalAllCommonComponent(~{ :: fragmentHorizontalLine}, true, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentHorizontalLine" th:remove="tag">
			<hr class="mt-4 mb-4">
		</div></th:block>
	</div>

	<!--/* 
		### navbar components.
	 */-->
	
	<!--/* internal common navBar component */-->
	<div th:fragment="internalNavbarCommonComponent(contents, label, options)" th:remove="tag">
 		<div th:replace="~{ :: internalAllCommonComponent(~{ :: fragmentNavbarCommonComponent}, false, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentNavbarCommonComponent" th:remove="tag">
			<th:block th:with="labelString=${@msgUtil.getValue(#locale, '__${label}__')}">
				<th:block th:replace="${contents}" />
			</th:block>
		</div></th:block>
	</div>

	<div th:fragment="internalNavbarItem(isSubMenuItem, method, options)" th:remove="tag">
		<th:block th:with="method=${#strings.isEmpty(method) ? 'get' : method}">
			<th:block th:if="${method == 'none'}">
				<span class="dropdown-item-text nav-link" style="white-space: nowrap" th:text="${labelString}"></span>
			</th:block>
			<th:block th:if="${method == 'post'}">
				<form method="post" name="navbarForm" th:action="${href}">
					<a th:class="${isSubMenuItem ? 'dropdown-item nav-link' : 'nav-link'}" href="javascript:navbarForm.submit()" th:text="${labelString}"></a>
				</form>
			</th:block>
			<th:block th:if="${method != 'none' and method != 'post'}">
				<a th:class="${isSubMenuItem ? 'dropdown-item nav-link' : 'nav-link'}" th:href="${href}" th:text="${labelString}"></a>
			</th:block>
		</th:block>
	</div>
	
	
	<!--/* navbarRoot */-->
	<!--/* parameters:
		- contentsOfNavBarRoot		contents passed from the caller.
		- title						navbar title.
		- imagePath					navbar image path.
		- defaultPagePath			navbar default destination page path when the title or image is clicked.
		- contentsOfNavBarRootRight contents placed at the right sice of the navbar and passed from the caller.
	 */-->
	<!--/* options:
		- backgroundColorClass		Specifies background-color with class name. ex. bg-secondary
		- isBackgroundGradient		Specifies whether isBackgroundGradient.
 	 */-->
 	<div th:fragment="navbarRoot(contentsOfNavBarRootLeft, title, imagePath, defaultPagePath, contentsOfNavBarRootRight, options)" th:remove="tag">
		<div th:replace="~{ :: internalNavbarCommonComponent(~{ :: fragmentNavBarRoot}, ${label}, ${options})}"></div>
		<th:block th:if="false"><div th:fragment="fragmentNavBarRoot" th:remove="tag">
			<th:block th:with="
					navbarBgColor=${@optUtil.getValueOrElse(options, 'backgroundColorClass', '')}
					, bsBgGradientOption=${@optUtil.getValueOrElse(options, 'isBackgroundGradient', null)},
					bsBgGradient=${bsBgGradientOption} != null ? ${bsBgGradientOption} : ${bsBgGradient}
					">
				<nav class="navbar navbar-expand-md navbar-dark"
						th:classappend="${(bsBgGradient ? 'bg-gradient' : '') 
						+ ' ' + (navbarBgColor == '' ? 'bg-color-navbar' : navbarBgColor)}">
					<div class="container-fluid">
						<a class="navbar-brand" th:href="${defaultPagePath == '' ? null : defaultPagePath}">
							<th:block th:if="${imagePath != ''}">
								<img th:src="${imagePath}" width="30" height="24" th:classappend="${navbarTitle == '' ? '' : 'd-inline-block align-text-top'}">
							</th:block>
							<th:block th:if="${title != ''}">
								<span th:text="${title}"></span>
							</th:block>
						</a>
						<th:block th:if="${@optUtil.getValueOrElse(options, 'showsNavbarMenuItems', 'true')}">
							<div class="container">
								<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
									<span class="navbar-toggler-icon"></span>
								</button>
					
								<div class="collapse navbar-collapse" id="navbarText">
									<ul class="navbar-nav me-auto mb-2 mb-lg-0" th:with="isPositionRight=false">

										<th:block th:replace="${contentsOfNavBarRootLeft}" />

									</ul>
								</div>
							</div>
							
							<div class="ml-auto">
								<ul class="navbar-nav me-auto mb-2 mb-lg-0" th:with="isPositionRight=true">
								
									<th:block th:replace="${contentsOfNavBarRootRight}" />
	
								</ul>
							</div>
						</th:block>								
					</div>
				</nav>
			</th:block>
		</div></th:block>
	</div>

	<!--/* navbarMenu: A menu link (not dropdown) placed on navigation bars. */-->
	<!--/* options:
		- method		Specifies the submit method. It can take 'get', 'post' or 'none' (no transision. just a label)
 	 */-->
	<div th:fragment="navbarMenuItem(href, label, options)" th:remove="tag">
		<div th:replace="~{ :: internalNavbarCommonComponent(~{ :: fragmentNavBarMenuItem}, ${label}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentNavBarMenuItem" th:remove="tag">
			<li class="nav-item" th:id="${componentId}" style="margin-left: 20px">
				 <div th:replace="~{ :: internalNavbarItem(false, ${@optUtil.getValueOrElse(options, 'method', 'get')}, ${options})}"></div>
			</li>
		</div></th:block>
	</div>
	
	<!--/* navbarMenu: A menu link (not dropdown) placed on navigation bars. */-->
	<div th:fragment="navbarSubMenu(label, menuItems, options)" th:remove="tag">
		<div th:replace="~{ :: internalNavbarCommonComponent(~{ :: fragmentNavbarSubMenu}, ${label}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentNavbarSubMenu" th:remove="tag">
			<li class="nav-item dropdown" th:id="${componentId}" style="margin-left: 20px" 
					th:with="imagePath=${@optUtil.getValueOrElse(options, 'imagePath', '')}">
					
				<a th:if="${imagePath == ''}" class="nav-link dropdown-toggle" href="#" role="button" 
						data-bs-toggle="dropdown" aria-expanded="false" th:text="${labelString}" />
				<a th:if="${imagePath != ''}" class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
					<img th:src="${imagePath}" alt="" width="27" height="27" style="filter: brightness(1) invert(1);" />
				</a>
				
				<ul class="dropdown-menu dropdown-menu-dark" 
						th:classappend="${(bsBgGradient == null || !bsBgGradient ? '' : 'bg-gradient') 
						+ ' ' + (navbarBgColor == '' ? 'bg-color-navbar' : navbarBgColor)
						+ ' ' + (isPositionRight ? 'dropdown-menu-end' : '')}">
						
					<th:block th:replace="${menuItems}" />

				</ul>
			</li>
		</div></th:block>
	</div>

	<!--/* navbarDropDownMenuItem */-->
	<div th:fragment="navbarDropDownMenuItem(href, label, options)" th:remove="tag">
		<div th:replace="~{ :: internalNavbarCommonComponent(~{ :: fragmentNavbarDropDownMenuItem}, ${label}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentNavbarDropDownMenuItem" th:remove="tag">
			<li th:id="${componentId}" class="nav-item">
				 <div th:replace="~{ :: internalNavbarItem(true, ${@optUtil.getValueOrElse(options, 'method', 'get')}, ${options})}"></div>
			</li>
		</div></th:block>
	</div>

	<!--/* navbarDropDownSubMenu */-->
	<div th:fragment="navbarDropDownSubMenu(label, menuItems, options)" th:remove="tag">
		<div th:replace="~{ :: internalNavbarCommonComponent(~{ :: fragmentNavbarDropDownSubMenu}, ${label}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentNavbarDropDownSubMenu" th:remove="tag">
			<li th:id="${componentId}">
				<a class="dropdown-item nav-link" href="#">
					<div style="text-align: left; float: left;" th:text="${labelString}"></div>
					<div style="text-align: right;" th:text="${@optUtil.getValueOrElse(options, 'direction', '') == 'left' ? '&ltrif;' : '&rtrif;'}">︎</div>
				</a>
				<ul class="dropdown-menu dropdown-submenu dropdown-menu-dark"
						th:classappend="${(bsBgGradient == null || !bsBgGradient ? '' : 'bg-gradient') 
						+ ' ' + (navbarBgColor == '' ? 'bg-color-navbar' : navbarBgColor)
						+ ' ' + (@optUtil.getValueOrElse(options, 'direction', '') == 'left' ? 'dropdown-submenu-left' : '')}">
					<th:block th:replace="${menuItems}" />
				</ul>
			</li>
		</div></th:block>
	</div>

	<!--/* navbarDropDownMenuDivider */-->
	<div th:fragment="navbarDropDownMenuDivider(options)" th:remove="tag">
		<div th:replace="~{ :: internalNavbarCommonComponent(~{ :: fragmentNavbarDropDownMenuDivider}, '', ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentNavbarDropDownMenuDivider" th:remove="tag">
			<li th:id="${componentId}"><hr class="dropdown-divider"></li>
		</div></th:block>
	</div>

	<!--/* navbarDropDownMenuGroupLabel */-->
	<!--/* 
		It's used when you want to put a classification label. 
		It's supposed to be placed at the top or right after the divider.
	*/-->
	<div th:fragment="navbarDropDownMenuGroupLabel(label, options)" th:remove="tag">
		<div th:replace="~{ :: internalNavbarCommonComponent(~{ :: fragmentNavbarDropDownMenuGroupLabel}, ${label}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentNavbarDropDownMenuGroupLabel" th:remove="tag">
			<li th:id="${componentId}" class="mb-1"><small>
				<div class="ms-3" style="font-weight: bold" th:text="${'&lt; &nbsp;' + labelString + '&nbsp; &gt;'}"></div>
			</small></li>
		</div>
	</div>

	<!--/* 
		### base-page buttonLook components.
	 */-->
	 
	<!--/* internalButtonLookComponent */-->
	<div th:fragment="internalButtonLookComponent(buttonLookContents, options)" th:remove="tag">
 		<div th:replace="~{ :: internalAllCommonComponent(~{ :: fragmentButtonLookComponent}, false, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentButtonLookComponent" th:remove="tag"
				th:with="buttonLookClasses=|btn text-white ${bsBgGradient == null || !bsBgGradient ? '' : 'bg-gradient'} 
						${@optUtil.getValueOrElse(options, 'backgroundColorClass', 'btn-color-btn')} ${classappend}|">
			
			<th:block th:replace="${buttonLookContents}" />
			
		</div></th:block>
	</div>

	<!--/* 
		### base-page button components.
	 */-->
	 
	<!--/* anchor */-->
	 <div th:fragment="anchor(href, label, isButtonLook, options)" th:remove="tag">
	 	<th:block th:if="${isButtonLook}">
	 		<div th:replace="~{ :: internalButtonLookComponent(~{ :: fragmentAButtonLook}, ${options})}"></div>
				 	
			<th:block th:if="false"><div th:fragment="fragmentAButtonLook" th:remove="tag">
				<a th:href=${href} th:class="${buttonLookClasses}">[[${label}]]</a>
			</div></th:block>
		</th:block>
		
	 	<th:block th:if="${!isButtonLook}">
	 		<div th:replace="~{ :: internalAllCommonComponent(~{ :: fragmentANoButtonLook}, ${options})}"></div>

			<th:block th:if="false"><div th:fragment="fragmentANoButtonLook" th:remove="tag">
				<a th:href=${href}>[[${label}]]</a>
			</div></th:block>
	 	</th:block>
	 </div>

	<!--/* 
		### base-page button components.
	 */-->

	<!--/* internalButtonCommonComponent */-->
	<!--/* parameters:
		- name					Specifies name attribute of the component.
		- label					Specifies the label of the component.
		- submits				Specifies whether the button submits a form.
 	 */-->
	<!--/* options:
		- id					Specifies id attribute of the component.
		- backgroundColorClass	Specifies the color of the background of the component
 	 */-->
	<div th:fragment="internalButtonCommonComponent(name, label, submits, options)" th:remove="tag"
			th:with="id=${@optUtil.getValueOrElse(options, 'id', name)}">
 		<div th:replace="~{ :: internalButtonLookComponent(~{ :: fragmentButtonCommonComponent}, 'id=' + ${id} + ',' + ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentButtonCommonComponent" th:remove="tag"
				th:with="id=${@optUtil.getValueOrElse(options, 'id', name)}">

			<button th:attr="${attr1Key}=${attr1Value}, ${attr2Key}=${attr2Value}, ${attr3Key}=${attr3Value}, ${attr4Key}=${attr4Value}, ${attr5Key}=${attr5Value}"
					th:type="${submits ? 'submit' : 'button'}" th:name="${name}" th:id="${id}" th:classappend="${buttonLookClasses}"
					th:text="${@msgUtil.getValue(#locale, label)}" th:disabled="${@optUtil.hasKey(options, 'disabled')}">
			</button>

		</div></th:block>
	</div>

	<!--/* scriptButton */-->
	<div th:fragment="scriptButton(id, label, options)" th:remove="tag">
 		<div th:replace="~{ :: internalButtonCommonComponent(null, ${label}, false, 'id=' + ${id} + ',' + ${options})}"></div>
	</div>
	
	<!--/* inter-button space */-->
	<span th:fragment="interButtonSpace(options)" th:remove="tag">
		<div th:replace="~{ :: internalAllCommonComponent(~{ :: fragmentInterButtonSpace}, false, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentInterButtonSpace" th:remove="tag">
			<span>&nbsp;&nbsp;&nbsp;</span>
		</div></th:block>
	</span>
	
	<!--/* 
		### base-page script components.
	 */-->

	<!--/* sendZoneOffset */-->
	<div th:fragment="sendZoneOffset(options)" th:remove="tag">
		<input type="hidden" id="zoneOffsetParams" th:data-url="@{/public/zoneOffset}">
		<script>
			var offset = new Date().getTimezoneOffset();
			var url = document.getElementById('zoneOffsetParams').dataset.url;
			var req = new XMLHttpRequest();

			req.open('GET', url + '?zoneOffset=' + offset, true);
			req.send(null);
		</script>
	</div>



	<!--/* 
		###
		### general-form-page components
		###
	 */-->

	<!--/* 
		### form components
	 */-->

	<!--/* generalForm */-->
	<div th:fragment="generalForm(formContent, topSpaceContent, bottomSpaceContent
			, formMethod, multipart, subFunction, options)" th:remove="tag">
 		<div th:replace="~{ :: internalAllCommonComponent(~{ :: fragmentGeneralForm}, true, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentGeneralForm" th:remove="tag">
			<th:block th:with="subFunction=${subFunction == null ? '' : subFunction}">
				<th:block th:with="javaFormName=${function + #strings.capitalize(subFunction) + 'Form'}">

					<th:block th:replace="${topSpaceContent}" />

					<!--/* issue#156: Since the error message is hard to understand when ${__${javaFormName}__} == null, understandable message output procedure is added. */-->
					<th:block th:if="${__${javaFormName}__} == null"
							th:with="msg=${'Form not found in model. Form name: ' + javaFormName + '. 
									The reason can be: Form with the name not defined; 
									Form is defined but not used (not set in the generics parameter of the controller definition sentence);'}">
						[[${@exUtil.systemError(msg)}]]
					</th:block>

					<!--/* Check #454 to understand how subFunction and ctrlSubFunction work. */-->
					<form th:name="${javaFormName}" th:id="${javaFormName}" 
							th:method="${formMethod == null || formMethod == '' ? 'post' : formMethod}"
							th:enctype="${multipart == null || multipart == false ? 'application/x-www-form-urlencoded' : 'multipart/form-data'}"
							th:action="@{/} + ${#strings.replace(loginState, '-', '/')} + '/' + ${functionKindsPathString} + ${function} + ${(ctrlSubFunction == null ? (subFunction == null || subFunction == '' ? '' : '/' + subFunction) : (ctrlSubFunction == '' ? '' : '/' + ctrlSubFunction)) + '/action'}"
							th:object="${__${javaFormName + '.' + rootRecordName}__}"
							onsubmit="doubleClickPreventionLockButtonsOnSubmit(event, this)"
							th:data-submitting-message="${@msgUtil.getValue(#locale, 'jp.ecuacion.splib.web.common.label.submitting')}">

						<th:block th:if="${@optUtil.getValueOrElse(options, 'transactionToken', 'true') != 'false'}">
							<input type="hidden" name="transactionToken" th:value="${transactionToken}">
						</th:block>

						<input type="hidden" name="action">

						<!--/* Show the form name with an error message to easily understand that the form name passed from controller to model is wrong. */-->
						<h1 style="color: red" th:if="${__${function + #strings.capitalize(subFunction) + 'Form'}__} == null">
							form: [[${function + #strings.capitalize(subFunction) + 'Form'}]] is null.
						</h1> 

						<input type="hidden" name="confirmedWarnings" th:value="${confirmedWarnings}">
			 			<input type="hidden" name="submitOnChangeToRefresh">
			 			<input type="hidden" th:id="${javaFormName + '.' + rootRecordName + '.ids'}" th:name="${rootRecordName + '.ids'}" 
			 					th:value="*{ids}">
						<input type="hidden" th:id="${javaFormName + '.' + rootRecordName + '.optimisticLockVersions'}" th:name="${rootRecordName + '.optimisticLockVersions'}" 
								th:value="*{optimisticLockVersions}" />
						<th:block th:replace="${formContent}" />

						<div th:replace="~{ :: internalWarnMessage('')}"></div>

		 			</form>

					<th:block th:replace="${bottomSpaceContent}" />

				</th:block>
			</th:block>
		</div></th:block>
	</div>

	<!--/* internal warn message part */-->
	<div th:fragment="internalWarnMessage(options)" th:remove="tag">
		<div th:object="${messagesBean}">
			<th:block th:if="*{warnMessage != null}">
				<input type="hidden" name="warnMessage" th:data-button-name="*{warnMessage.buttonName}" th:data-msg-id="*{warnMessage.messageId}" th:value="*{warnMessage.message}">
				<script>
					var bl = confirm(this.form.elements['warnMessage'].value);
					var obj = this.form.elements['confirmedWarnings'];
					if (bl) {
						obj.value = obj.value + "," + this.form.elements['warnMessage'].dataset.msgId;
						
						const buttonName = this.form.elements['warnMessage'].dataset.buttonName;
						if (typeof buttonName === "undefined") {
							buttonName = "";
						}
						
						if (buttonName == "") {
							this.form.submit();

						} else {
							var btn = this.form.elements[buttonName];
							btn.click();
						}
						
					} else {
						obj.value = "";
					}
				</script>
			</th:block>
		</div>
	</div>

	<!--/* 
		### general-form-page input components
	 */-->

	<!--/* internalAllInputCommonComponent. */-->
	<!--/* parameters: 
			- itemPropertyPath			String 		not empty	itemPropertyPath (recordPropertyPath NOT accepted)
			- allInputContents			Fragment	not empty	a fragment of the component
			- allInputPostfixContents	Fragment	empty OK	a fragment of the component
			- required					boolean		not null	a boolean which specifies whether the input component is required to input something.
			- needsLabel				boolean		not null	a boolean which specifies whether the input component is required to input something.
			- needsFieldEmssages		boolean		not null	a boolean which specifies whether the input component is required to input something.
			- labelPostfix				String		not null	postfix for label. When you don't need it, set blank('').
			- options					String		not null	options for the component. When you don't need it, set blank('').
	*/-->
	<!--/* options: 
			- id			arbitrary	specifies 'id' attribute of the html component. As default "javaFormName + '.' + propertyPath"
			- width			arbitrary	specifies width of the html component. values can be 'full' or 'half'.
			- componentType	arbitrary	speciifes the kind of the component. Used to change the look or action by its type.
			                            'switch' is used in the fragment for now.
			- readOnly		arbitrary	specifies whether the component is read-only.			                            
	*/-->
	<div th:fragment="internalAllInputCommonComponent(itemPropertyPath, allInputContents, allInputPostfixContents, required, needsLabel, needsFieldEmssages, 
			labelPostfix, options)" th:remove="tag" 
			th:with="recordPropertyPathClass=${itemPropertyPath.contains('.') ? rootRecordName + '.' + itemPropertyPath.substring(0, itemPropertyPath.lastIndexOf('.')) : rootRecordName},
					propertyPathField=${itemPropertyPath.contains('.') ? itemPropertyPath.substring(itemPropertyPath.lastIndexOf('.') + 1) : itemPropertyPath},
					itemNameKeyClass=${itemPropertyPath.contains('.') ? itemPropertyPath.substring(itemPropertyPath.lastIndexOf('.') + 1) : rootRecordName}
			">

		<th:block th:with="id=${@optUtil.getValueOrElse(options, 'id', javaFormName + '.' + recordPropertyPathClass + '.' + propertyPathField)}">
		
			<!--/* submitOnChangeToRefresh should be the last event because it submits. */-->
	 		<div th:replace="~{ :: internalAllCommonComponent(~{ :: fragmentAllInputCommonComponent}, false, 
	 				 ${options} + ',' + ${@optUtil.hasKey(options, 'submitOnChangeToRefresh') ? 'event=change|submitOnChangeToRefresh' : ''})}"></div>				
	
			<th:block th:if="false"><div th:fragment="fragmentAllInputCommonComponent" th:remove="tag">
				<th:block th:with="recordPropertyPath=${recordPropertyPathClass + '.' + propertyPathField},
						isDisabled=${@optUtil.hasKey(options, 'disabled')},
						isReadOnly=${@optUtil.hasKey(options, 'readonly') || isDisabled}">
					<th:block th:with="inputValue=*{__${itemPropertyPath}__}, 
							inputName=${isDisabled ? null : recordPropertyPath},
							inputId=${id},
							widthValue=${@optUtil.getValueOrElse(options, 'width', '')}, 
							widthNumber=${@optUtil.hasKey(options, 'width') ? (widthValue == 'full' ? '12' : (widthValue == 'half' ? '6' : widthValue)) : ''}">
		
						<div th:id="${componentId}" class="" th:classappend="${widthNumber == '' ? 'col-xl-3 col-lg-4 col-md-6' : 'col-md-' + widthNumber} + ' '
								+ ${mtClass} + ' ' + ${mbClass == '' ? 'mb-4' : mbClass}
						">

							<!--/* label */-->
							<th:block th:if="${needsLabel}"
									th:with="itemNameKey=*{getItem('__${itemPropertyPath}__').getItemNameKey('__${rootRecordName}__')}">
								<label th:for="${inputId}" class="form-label text-dark mb-0">
									[[${@msgUtil.getValue(#locale, '__${itemNameKey}__') + labelPostfix}]]
									<span class="text-danger" th:if="${required}">*</span>
									[[${@optUtil.hasKey(options, 'submitOnChangeToRefresh') ? ' ' + @msgUtil.getValue(#locale, 'jp.ecuacion.splib.web.common.label.submitOnChangeToRefresh') : ''}]]
									<span th:if="${@optUtil.hasKey(options, 'tooltip')}"
											th:data-bs-toggle="${@optUtil.hasKey(options, 'tooltip') ? 'tooltip' : ' '}" 
											th:data-bs-title="${@msgUtil.getValue(#locale, @optUtil.getValueOrElse(options, 'tooltip', ''))}"
											th:data-tooltip-sanitize="${@optUtil.getValueOrElse(options, 'tooltipSanitize', true)}"
											data-bs-custom-class="bs-tooltip">
										<svg width="20" height="20">
											<circle cx="8" cy="8" r="8" class="tooltip-icon" />
											<text x="8" y="9" font-family="Rokkitt" font-weight="bold" font-size="15" fill="white"
													text-anchor="middle" dominant-baseline="middle">i</text>
										</svg>
									</span>
								</label>
							</th:block>

							<!--/* content */-->
							<th:block th:replace="${allInputContents}" />
							
							<!--/* field messages */-->
							<th:block th:if="${@propUtil.getValueOrElse('jp.ecuacion.splib.web.process-result-message.shown-at-each-item', true)} and ${needsFieldEmssages}">
								<div class="text-danger" th:if="${messagesBean.getErrorMessagesAtEachItem('__${itemPropertyPath}__').size() > 0}"
									th:classappend="${@optUtil.hasKey(options, 'componentType') and @optUtil.getValue(options, 'componentType') == 'switch' ? 'mt-1' : ''}"
									th:each="message : ${messagesBean.getErrorMessagesAtEachItem('__${itemPropertyPath}__')}">[[${message}]]</div>
							</th:block>
							
							<!--/* postfix content */-->
							<th:block th:replace="${allInputPostfixContents}" />
							
						</div>
					</th:block>
				</th:block>
			</div></th:block>
		</th:block>
	</div>

	<!--/* internalAllHtmlInputComponent. */-->
	<!--/* external paramters:
			- 
	 */-->
	<!--/* options: 
			- value			string	specifies 'value' attribute. Used to hide confidential strings.
	*/-->
	<div th:fragment="internalAllHtmlInputComponent(position)" th:remove="tag">
		<input th:type="${type}" th:id="${inputId}" th:name="${inputName}" 
				th:value="${@optUtil.hasKey(options, 'value') ? @msgUtil.getValue(#locale, @optUtil.getValue(options, 'value')) : inputValue}"
				th:maxlength="${isReadOnly || type == 'hidden' || needsMaxLength == null || !needsMaxLength} ? '' : *{getStringLength('__${propertyPathField}__')}"
				class="form-control text-dark"
				th:classappend="${isReadOnly ? 'input-read-only' : ''}
						+ ' ' + ${position == 'right' ? 'text-end' : ''}
						+ ' ' + ${messagesBean.isValid(itemPropertyPath)}" 
				th:readonly="${isReadOnly}">
	</div>

	<!--/* internalAllHtmlInputNumberComponent. */-->
	<div th:fragment="internalAllHtmlInputNumberComponent" th:remove="tag">
		<th:block th:with="needsCommas=*{__${rootRecordName}__.needsCommas('__${rootRecordName}__', '__${itemPropertyPath}__')}">
			<th:block th:with="type=text, inputValue=${(needsCommas && inputValue != null) ? #numbers.formatDecimal(#strings.replace(inputValue, ',', ''), 1, 'COMMA', 0, 'POINT') : inputValue}">
				<div th:replace="~{ :: internalAllHtmlInputComponent('right')}"></div>
			</th:block>
			<th:block th:if="${needsCommas}">
				<script th:inline="javascript">
					addNumberFormatFunction(/*[[${inputId}]]*/);
				</script>
			</th:block>
		</th:block>
	</div>

	<!--/* internalAllHtmlSelectComponent. */-->
	<div th:fragment="internalAllHtmlSelectComponent" th:remove="tag">
		<!--/* disabled is used because select component does not have readonly readOnly attribute */-->
		<th:block th:if="${isReadOnly}">
			<input type="hidden" th:id="${@optUtil.hasKey(options, 'id') ? recordPropertyPath : null}" th:name="${recordPropertyPath}" th:value="${inputValue}">
		</th:block>

		<select th:id="${inputId}" th:name="${inputName}"
				class="form-select text-dark" 
				th:classappend="${isReadOnly ? 'input-read-only' : ''}
				 + ' ' + ${messagesBean.isValid(itemPropertyPath)}"
				th:disabled="${isReadOnly}">
				
			<option th:if="${!@optUtil.hasKey(options, 'noEmptyOption')}" th:selected="${inputValue == null || inputValue == ''}"></option>
			<th:block th:each="pair : ${pairs}">
				<!--/* in case of select from boolean, inputValue (received from form) is boolean.
				       since 'true' == true is false in thymeleaf, data type of inputValue is changed to string
				       by #strings.trim(). */-->
				<option th:value="${pair[0]}" th:selected="${pair[0] == #strings.trim(inputValue)}">[[${pair[1]}]]</option>
			</th:block>
		</select>
	</div>
	
	<!--/* internalAllHtmlCheckboxComponent. */-->
	<div th:fragment="internalAllHtmlCheckboxComponent(isFormSwitch)" th:remove="tag">
		<div class="form-check mt-2" th:classappend="${isFormSwitch ? 'form-switch' : ''}">
			<th:block th:if="${isReadOnly}">
				<input type="hidden" th:id="${inputId}" th:name="${inputName}" th:value="${inputValue}">
			</th:block>
			<div>
				<!--/* https://stackoverflow.com/questions/1809494/post-unchecked-html-checkboxes */-->
				<input th:if="${!isReadOnly}" type="hidden" th:name="${inputName}" value="off">
				<input th:id="${inputId}" th:name="${isReadOnly ? '' : inputName}"
					class="form-check-input align-bottom mb-1" type="checkbox" 
					th:checked="${inputValue}"
					th:classappend="${messagesBean.isValid(itemPropertyPath)}"
					th:disabled="${isReadOnly}">
			</div>
		</div>
	</div>

	<!--/* internalEditInputCommonComponent. */-->
	<div th:fragment="internalEditInputCommonComponent(itemPropertyPath, editInputContents, editInputContentsPostfix, options)" th:remove="tag">
		<!--/* #authentication.principal is a bean which stores multiple values when logged in, but is a String when not logged in. That's why the check whether its dataType is string is needed. */-->
 		<div th:replace="~{ :: internalAllInputCommonComponent(${itemPropertyPath}, ~{ :: fragmentEditInputCommonComponent}, ${editInputContentsPostfix}, 
 				*{isNotEmpty('__${itemPropertyPath}__', '__${loginState}__', '__${#authentication.principal.class.name == 'java.lang.String' ? '' : #authentication.principal.authorities}__')},
 				 true, true, '',  ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentEditInputCommonComponent" th:remove="tag">
			<th:block th:replace="${editInputContents}" />
		</div></th:block>
		
	</div>
	
	<!--/* internalEditInputTextComponent. */-->
	<div th:fragment="internalEditInputTextComponent(itemPropertyPath, type, needsMaxLength, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputCommonComponent(${itemPropertyPath}, ~{ :: internalAllHtmlInputComponent('left')}, ~{bootstrap/components :: nullFragment}, ${options})}"></div>
	</div>
	
	<!--/* textbox */-->
	<div th:fragment="inputText(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputTextComponent(${itemPropertyPath}, 'text', true, ${options})}"></div>
	</div>
				
	<!--/* textbox(password) */-->
	<div th:fragment="inputPassword(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputTextComponent(${itemPropertyPath}, 'password', true, ${options})}"></div>
	</div>

	<!--/* hidden */-->
	<div th:fragment="inputHidden(itemPropertyPath, options)" th:remove="tag">
		<th:block th:with="type=hidden">
	 		<div th:replace="~{ :: internalAllInputCommonComponent(${itemPropertyPath}, ~{ :: internalAllHtmlInputComponent(null)}, ~{bootstrap/components :: nullFragment}, 
	 				false, false, false, '',  ${options})}"></div>
 		</th:block>
	</div>
	
	<!--/* inputNumber */-->
	<div th:fragment="inputNumber(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputCommonComponent(${itemPropertyPath}, ~{ :: internalAllHtmlInputNumberComponent}, ~{bootstrap/components :: nullFragment}, ${options})}"></div>
	</div>
	
	<!--/* internal common component. It's not supposed to use directly from thymeleaf web pages. */-->
	<div th:fragment="internalEditInputDateTime(itemPropertyPath, type, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputTextComponent(${itemPropertyPath}, ${type}, false, ${options})}"></div>
	</div>	

	<!--/* textbox(month) */-->
	<div th:fragment="inputYearMonth(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputDateTime(${itemPropertyPath}, 'month', ${options})}"></div>
	</div>

	<!--/* textbox(date) */-->
	<div th:fragment="inputDate(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputDateTime(${itemPropertyPath}, 'date', ${options})}"></div>
	</div>

	<!--/* textbox(time) */-->
	<div th:fragment="inputTime(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputDateTime(${itemPropertyPath}, 'time', ${options})}"></div>
	</div>
	
	<!--/* inputDateTime (always disabled) */-->
	<div th:fragment="inputDateTime(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputTextComponent(${itemPropertyPath}, 'text', true, 'disabled,' + ${options})}"></div>
	</div>

	<!--/* textarea */-->
 	<div th:fragment="inputTextArea(itemPropertyPath, options)" th:remove="tag">
 		<div th:replace="~{ :: internalEditInputCommonComponent(${itemPropertyPath}, ~{ ::fragmentInputTextArea}, ~{bootstrap/components :: nullFragment}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentInputTextArea" th:remove="tag">
			<textarea th:id="${inputId}" th:name="${inputName}" th:text="${inputValue}"
				th:maxlength="*{__${recordPropertyPathClass}__.getStringLength('__${propertyPathField}__')}" 
				class="text-dark"
				th:classappend="${(isReadOnly) ? 'form-control-plaintext' : 'form-control ' + messagesBean.isValid(itemPropertyPath)}" 
				th:readonly="${isReadOnly}" rows="3">
			</textarea>
		</div></th:block>
	</div>

	<!--/* textarea which shows docments like service agreement. */-->
 	<div th:fragment="inputDocumentViewer(itemPropertyPath, options)" th:remove="tag">
 		<div th:replace="~{ :: internalEditInputCommonComponent(${itemPropertyPath}, ~{ ::fragmentInputDocumentViewer}, ~{bootstrap/components :: nullFragment}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentInputDocumentViewer" th:remove="tag">
			<textarea th:id="${inputId}" th:name="${inputName}" th:text="${inputValue}"
				class="form-control input-document-viewer-design text-dark"
				th:readonly=true rows="20">
			</textarea>
		</div></th:block>
	</div>

	<!--/* checkbox */-->
	<div th:fragment="inputCheckbox(itemPropertyPath, options)" th:remove="tag">
 		<div th:replace="~{ :: internalEditInputCommonComponent(${itemPropertyPath}, ~{ ::internalAllHtmlCheckboxComponent(false)}, ~{bootstrap/components :: nullFragment}, ${options + ',componentType=switch'})}"></div>
	</div>

	<!--/* checkbox (switch) */-->
	<div th:fragment="inputSwitch(itemPropertyPath, options)" th:remove="tag">
 		<div th:replace="~{ :: internalEditInputCommonComponent(${itemPropertyPath}, ~{ ::internalAllHtmlCheckboxComponent(true)}, ~{bootstrap/components :: nullFragment}, ${options + ',componentType=switch'})}"></div>
	</div>
	 
	<!--/* checkbox */-->
	<div th:fragment="inputCheckboxes(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputCommonComponent(${itemPropertyPath}, ~{ ::fragmentInputCheckboxes}, ~{bootstrap/components :: nullFragment}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentInputCheckboxes" th:remove="tag">
			<div class="form-check mt-2" th:each="option : *{__${itemPropertyPath + 'List'}__}">
				<th:block th:with="optionId=${option[0]},optionLabel=${option[1]},optionOptions=${option.length == 2 ? '' : option[2]}">
					<input th:id="${optionId}" class="form-check-input align-bottom mb-1" type="checkbox" 
						th:name="${isReadOnly ? '' : recordPropertyPath}" 
						th:checked="${inputValue == null ? false : #strings.contains(inputValue, optionId)}"
						th:classappend="${messagesBean.isValid(itemPropertyPath)}"
						th:disabled="${isReadOnly}"
						th:value="${optionId}">
					<label class="form-check-label text-dark" th:for="${optionId}" th:text="${optionLabel}"></label>
					<th:block th:if="${isReadOnly}">
						<input type="hidden" th:name="${recordPropertyPath}" th:value="${optionId}">
					</th:block>
				</th:block>
			</div>
		</div></th:block>
	</div>

	<!--/* internal common component. It's not supposed to use directly from thymeleaf web pages. */-->
	<div th:fragment="internalEditInputSelectComponent(itemPropertyPath, pairs, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputCommonComponent(${itemPropertyPath}, ~{ :: internalAllHtmlSelectComponent}, ~{bootstrap/components :: nullFragment}, ${options})}"></div>
	</div>
	
	<div th:fragment="inputSelect(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputSelectComponent(${itemPropertyPath}, *{__${@strUtil.selectListMethodName(itemPropertyPath)}__()}, ${options})}"></div>
	</div>
	
	<div th:fragment="inputSelectWithLocale(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputSelectComponent(${itemPropertyPath}, 
				*{__${@strUtil.selectListMethodName(itemPropertyPath)}__(#locale, '__${options}__')}, ${options})}"></div>
	</div>
	
	<!--/* 
		- options:
		  - including: Shows selections specified in this options only. Example: 'include=ADMIN,GROUP_ADMIN' Element name of the enum, not the code value.
		  - excluding: Shows selections NOT specified in this options only. Example: 'include=ADMIN,GROUP_ADMIN' Element name of the enum, not the code value.
		  - firstCharOfCodeEqualTo: Shows selections whose first character is equal to the one specified.
		  - firstCharOfCodeLessThanOrEqualTo: Shows selections whose first character is less than or equal to the one spefied. Compared by ascii code number.
		  - firstCharOfCodeGreaterThanOrEqualTo: Shows selections whose first character is greaterl than or equal to the one spefied. Compared by ascii code number.
	 */-->
	<div th:fragment="inputSelectFromEnum(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputSelectComponent(${itemPropertyPath}, 
				*{__${@strUtil.selectListMethodNameForEnum(itemPropertyPath)}__(#locale, '__${options}__')}, ${options})}"></div>
	</div>
	
	<!--/* component for file upload */-->
	<div  th:fragment="inputFile(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputCommonComponent(${itemPropertyPath}, ~{ :: fragmentInputFile}, ~{bootstrap/components :: nullFragment}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentInputFile" th:remove="tag">
			<input class="form-control" type="file" th:id="${inputId}" th:name="${inputName}" 
					th:classappend="${messagesBean.isValid(itemPropertyPath)}">
		</div></th:block>
	</div>
	
	<!--/* component for taken photo upload for mobile */-->
	<div  th:fragment="inputTakenPhotoMobile(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputCommonComponent(${itemPropertyPath}, ~{ :: fragmentInputTakenPhotoMobile}, ~{ :: fragmentInputTakenPhotoMobilePostfix}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentInputTakenPhotoMobile" th:remove="tag">
			<input class="form-control" th:classappend="${messagesBean.isValid(itemPropertyPath)}" 
					type="file" th:name="${recordPropertyPath}"  th:id="${inputId}" accept="image/*" capture="user">
		</div></th:block>
		
		<th:block th:if="false"><div th:fragment="fragmentInputTakenPhotoMobilePostfix" th:remove="tag">
			<th:block th:with="photoData=*{__${recordPropertyPath + 'RegisteredBase64'}__}">
				<th:block th:if="${!#strings.isEmpty(photoData)}">
					<br>
					[[${@msgUtil.getValue(#locale, 'jp.ecuacion.splib.web.components.inputTakenPhoto.registeredPhoto')}]]
					<img class="img-fluid" th:src="${photoData}" style="border: 1px solid #000;">
				</th:block>
			</th:block>
		</div></th:block>
	</div>

	<!--/* component for taken photo upload for PC */-->
	<div  th:fragment="inputTakenPhotoPc(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputCommonComponent(${itemPropertyPath}, ~{ :: fragmentInputTakenPhotoPc}, ~{bootstrap/components :: nullFragment}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentInputTakenPhotoPc" th:remove="tag">
			<video th:id="${'video-' + inputId}" width="320" height="240" autoplay muted style="border: 1px solid #000;"></video>
			<canvas th:id="${'canvas-' + inputId}" width="320" height="240"></canvas>
			<img th:id="${'photo-' + inputId}" src="#" alt="taken photo" style="border: 1px solid #000;">
			<input type="hidden" th:id="${inputId}" th:name="${inputName}" th:value="${inputValue}">
			<div class="mt-2"></div>
			<button th:id="${'allowance-' + inputId}" type="button" style="vertical-align: bottom;" class="btn btn-sm btn-color-btn text-white bg-gradient" 
					th:text="${@msgUtil.getValue(#locale, 'jp.ecuacion.splib.web.components.inputTakenPhotoPc.photoShootingButtonLabel')}"></button>
			<button th:id="${'capture-' + inputId}" type="button" style="vertical-align: center;" class="btn btn-sm btn-color-btn text-white bg-gradient"
					th:text="${@msgUtil.getValue(#locale, 'jp.ecuacion.splib.web.components.inputTakenPhotoPc.shootButtonLabel')}"></button>
			<button th:id="${'recapture-' + inputId}" type="button" style="vertical-align: bottom;" class="btn btn-sm btn-color-btn text-white bg-gradient"
					th:text="${@msgUtil.getValue(#locale, 'jp.ecuacion.splib.web.components.inputTakenPhotoPc.reshootButtonLabel')}"></button>
		
			<script>
				const video = document.getElementById('video-[[${inputId}]]');
				const canvas = document.getElementById('canvas-[[${inputId}]]');
				const photo = document.getElementById('photo-[[${inputId}]]');
				const hidden = document.getElementById('[[${inputId}]]');
				const allowanceButton = document.getElementById('allowance-[[${inputId}]]');
				const captureButton = document.getElementById('capture-[[${inputId}]]');
				const recaptureButton = document.getElementById('recapture-[[${inputId}]]');
				let stream;
		
				video.style.display = 'none';
				canvas.style.display = 'none';
				photo.style.display = 'none';
				captureButton.style.display = 'none';
				recaptureButton.style.display = 'none';
				
				if (hidden.value != "") {
					photo.style.display = 'flex';
					photo.setAttribute('src', hidden.value);
				}
				
				// Procedure for allowance button pressed
				allowanceButton.addEventListener('click', function() {
					// Request for the access allowance of camera.
					navigator.mediaDevices.getUserMedia({ video: true })
						.then(function(mediaStream) {
							stream = mediaStream;
							video.srcObject = stream;
							video.onloadedmetadata = function(e) {
							  video.play();
							};
		
							video.style.display = 'flex';
							photo.style.display = 'none';
							allowanceButton.style.display = 'none';
							captureButton.style.display = 'flex';
							
							// Get photo data from canvas.
							photo.setAttribute('src', '');
							hidden.value = '';
						})
						.catch(function(err) {
							console.log("Access error to camera: " + err);
						});
				});
		
				// Procedure for capture button pressed
				captureButton.addEventListener('click', function() {
					const context = canvas.getContext('2d');
					context.drawImage(video, 0, 0, canvas.width, canvas.height);
					 
					video.style.display = 'none';
					photo.style.display = 'flex';
					captureButton.style.display = 'none';
					recaptureButton.style.display = 'inline-block';

					// Get photo data from canvas.
					photo.setAttribute('src', canvas.toDataURL('image/jpeg'));
					hidden.value = canvas.toDataURL('image/jpeg');
				});

				// Procedure for recapture button pressed
				recaptureButton.addEventListener('click', function() {
					const context = canvas.getContext('2d');
					context.drawImage(video, 0, 0, canvas.width, canvas.height);
	
					video.style.display = 'flex';
					photo.style.display = 'none';
					captureButton.style.display = 'inline-block';
					recaptureButton.style.display = 'none';
					
					// Clear photo data.
					photo.setAttribute('src', '');
					hidden.value = '';
				});
			</script>
		</div></th:block>
	</div>
	
	<!--/* component for captcha */-->
	<!--/* 
		- When itemPropertyPath is "sampleField", image data should be put in "sampleFieldImageData"
		  amd input string in "sampleField"
		- Put BASE64 String with "data:image/xxx;base64, prefix" to the field that itemPropertyPath + "ImageData" specifies. 
	*/-->
	<div  th:fragment="inputCaptcha(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalEditInputCommonComponent(${itemPropertyPath}, ~{ :: fragmentInputCaptcha}, ~{bootstrap/components :: nullFragment}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentInputCaptcha" th:remove="tag">
			<img class="img-fluid mb-2" th:src="*{__${itemPropertyPath}__ImageData}" style="border: 1px solid #000;">

			<div th:with="type=text,needsMaxLength=false,isReadOnly=false">
				<div th:replace="~{ :: internalAllHtmlInputComponent('left')}"></div>
			</div>
		</div></th:block>
	</div>

	<!--/* 
		### general-form-page button
	 */-->

	<!--/* submitButton */-->
	<div th:fragment="submitButton(name, label, options)" th:remove="tag">
 		<div th:replace="~{ :: internalButtonCommonComponent(${name}, ${label}, true, 
 				${@optUtil.getValueOrElse(options, 'disabledOnSubmit', 'true') == 'true' ? 
 						('attr=data-disabled-on-submit|true,attr=data-original-label|' + @msgUtil.getValue(#locale, label) + ',') : ''} 
 				+ ${options})}"></div>
	</div>

	<div th:fragment="downloadButton(name, label, options)" th:remove="tag">
 		<div th:replace="~{ :: submitButton(${name}, ${label}, 'event=click|waitForDownloadToFinish,' + ${options})}"></div>
	</div>



	<!--/* 
		###
		### edit-page components
		###
	 */-->

	<!--/* 
		### edit-page button
	 */-->

	<!--/* insertOrUpdateButton */-->
	<div th:fragment="insertOrUpdateButton(isInsert, options)" th:remove="tag">
		<div th:replace="~{ :: submitButton('insertOrUpdate', 
				${isInsert ? 'jp.ecuacion.splib.web.common.button.insert' : 'jp.ecuacion.splib.web.common.button.update'}, ${options})}"></div>
	</div>
	
	<!--/* backButton */-->
	<div th:fragment="backButton(options)" th:remove="tag">
		<div th:replace="~{ :: submitButton('back', 'jp.ecuacion.splib.web.common.button.back', ${options})}"></div>
	</div>



	<!--/* 
		###
		### search-page components
		###
	 */-->
	
	<!--/* 
		### search-page input components
	 */-->
	 
	<!--/* internal common component. It's not supposed to use directly from thymeleaf web pages. */-->
	<div th:fragment="internalSearchInputCommonComponent(itemPropertyPath, searchInputContents, labelPostfix, options)" th:remove="tag">
		<!--/* #authentication.principal is a bean which stores multiple values when logged in, but is a String when not logged in. That's why the check whether its dataType is string is needed. */-->
		<div th:replace="~{ :: internalAllInputCommonComponent(${itemPropertyPath}, ~{ :: fragmentSearchInputCommonComponent}, ~{bootstrap/components :: nullFragment}, 
		*{isNotEmptyOnSearch('__${itemPropertyPath}__', '__${loginState}__', '__${#authentication.principal.class.name == 'java.lang.String' ? '' : #authentication.principal.authorities}__')},
		true, true, ${labelPostfix}, ${options})}"></div>

		<th:block th:if="false"><div th:fragment="fragmentSearchInputCommonComponent" th:remove="tag">
			<th:block th:replace="${searchInputContents}" />
		</div></th:block>
	</div>
	
	<div th:fragment="searchText(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalSearchInputCommonComponent(${itemPropertyPath}, ~{ :: internalAllHtmlInputComponent('left')}, 
				*{getSearchPatternComment(#locale, '__${itemPropertyPath}__')}, ${options})}"></div>
	</div>

	<div th:fragment="searchNumber(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalSearchInputCommonComponent(${itemPropertyPath}, ~{ ::searchNumberInternal(${itemPropertyPath}, ${options})}, '',  ${options})}"></div>

		<th:block th:if="false"><div th:fragment="searchNumberInternal(itemPropertyPath, options)" th:remove="tag">
			<input type="text" th:id="${@optUtil.hasKey(options, 'id') ? inputId : null}" th:name="${inputId}" th:value="${inputValue}"
				class="text-end"
				th:classappend="${(isReadOnly) ? 'form-control-plaintext' : 'form-control ' + messagesBean.isValid(inputId)}"
				th:maxlength="${isReadOnly} ? '' : *{getStringLength('__${fieldName}__')}"
				th:readonly="${isReadOnly}">
		</div></th:block>
	</div>

	<div th:fragment="searchDate(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalSearchInputCommonComponent(${itemPropertyPath}, ~{ ::searchDateInternal(${itemPropertyPath}, ${options})}, '',  ${options})}"></div>

		<th:block th:if="false"><div th:fragment="searchDateInternal(itemPropertyPath, options)" th:remove="tag">
			<input type="date" th:id="${@optUtil.hasKey(options, 'id') ? inputId : null}" th:name="${inputId}" th:value="${inputValue}"
				th:classappend="${(isReadOnly) ? 'form-control-plaintext' : 'form-control ' + messagesBean.isValid(inputId)}" 
				th:readonly="${isReadOnly}">
		</div></th:block>
	</div>
	
	<!--/* internal common component */-->
	<div th:fragment="searchComponentSelect(itemPropertyPath, pairs, options)" th:remove="tag">
		<div th:replace="~{ :: internalSearchInputCommonComponent(${itemPropertyPath}, ~{ :: internalAllHtmlSelectComponent}, '',  ${options})}"></div>
	</div>

	<div th:fragment="searchSelect(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: searchComponentSelect(${itemPropertyPath}, 
				*{__${@strUtil.selectListMethodName(itemPropertyPath)}__()}, ${options})}"></div>
	</div>
	
	<!--/* 
		- options:
		  - including: 指定したEnum要素のみをプルダウンに表示。'include=ADMIN,GROUP_ADMIN' など、enumの要素名で、カンマ区切り指定。（codeではない）
		  - excluding: 指定したEnum要素以外をプルダウンに表示。'exclude=ADMIN,GROUP_ADMIN' など、enumの要素名で、カンマ区切り指定。（codeではない）
		  - firstCharOfCodeEqualTo: codeの一文字目が等しい場合にtrue
		  - firstCharOfCodeLessThanOrEqualTo: codeの一文字目をascii codeの大小で比較
		  - firstCharOfCodeGreaterThanOrEqualTo: codeの一文字目をascii codeの大小で比較
	 */-->
	<div th:fragment="searchSelectFromEnum(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: searchComponentSelect(${itemPropertyPath}, 
				*{__${@strUtil.selectListMethodNameForEnum(itemPropertyPath)}__(#locale, '__${options}__')}, ${options})}"></div>
	</div>

	<div th:fragment="searchSelectFromBoolean(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: searchComponentSelect(${itemPropertyPath}, 
				*{__${@strUtil.selectListMethodNameForEnum(itemPropertyPath)}__(#locale, '__${options}__')}, ${options})}"></div>
	</div>

	<!--/* 
		### search-page button components
	 */-->

	<!--/* searchButton */-->
	<div th:fragment="searchButton(options)" th:remove="tag">
		<div th:replace="~{ :: submitButton('search', 'jp.ecuacion.splib.web.common.button.search', 'disabledOnSubmit=true,' + ${options})}"></div>
	</div>

	<!--/* searchConditionClearButton */-->
	<div th:fragment="searchConditionClearButton(options)" th:remove="tag">
		<div th:replace="~{ :: submitButton('conditionClear', 'jp.ecuacion.splib.web.common.button.conditionClear', 'disabledOnSubmit=true,' + ${options})}"></div>
	</div>
	
	<!--/* 
		### search result display condition components (sort, pagination and lines of display in the table)
	 */-->
	
	<!--/* component which is integrated with functions of sort, paging and lines of data */-->
	<div th:fragment="sortPagingAndRecordsInScreen(form, options)" th:remove="tag">
		<input type="hidden" id="sortItem" name="sortItem" th:value="${form.sortItem}">
		<input type="hidden" id="direction" name="direction" th:value="${form.direction}">
		<input type="hidden" id="page" name="page" th:value="${form.page}">
		<input type="hidden" id="recordsInScreen" name="recordsInScreen" th:value="${form.recordsInScreen}">
		<input type="hidden" id="requestFromSearchForm" name="requestFromSearchForm" value="true">
		<div class="container-fluid">
			<div class="row">
				<div class="col-md-4 align-self-end">
					<div class="text-dark">[[${form.linesInScreen}]]</div>
				</div>
				<div class="col-md-4">
					<nav aria-label="Page navigation" th:if="${form.getPagerInfoList(#locale).size() > 0}">
						<ul class="pagination justify-content-center">
							<th:block th:each="pagerInfo : ${form.getPagerInfoList(#locale)}" th:object="${pagerInfo}" th:remove="tag">
								<li class="page-item" th:classappend="*{status}">
									<a th:if="*{isDisabled()}" class="page-link text-light" href="#" tabindex="-1" aria-disabled="true" th:text="*{displayString}"></a>
									<a th:if="*{!isDisabled()}" class="page-link" th:data-page="*{goToPage}" 
											href="#" onClick="listFromPage(this.dataset.page);" th:text="*{displayString}"></a>
								</li>
							</th:block>
						</ul>
					</nav>
				</div>
				<div class="col-md-4" style="text-align:right; padding-right: 0px">
					<div class="dropdown">
						<div th:replace="~{ :: submitButton('searchAgain', 'jp.ecuacion.splib.web.common.label.recordsInScreen', 
								'disabledOnSubmit=true,' + 'id=dropdownMenuButton1,attr=data-bs-toggle|dropdown,classappend=dropdown-toggle,classappend=mb-3' + ${options})}"></div>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item text-dark" href="javascript:listFromRecordsInScreen(document.getElementById('dropdownMenuButton1'), 5)">5</a></li>
							<li><a class="dropdown-item text-dark" href="javascript:listFromRecordsInScreen(document.getElementById('dropdownMenuButton1'), 10)">10</a></li>
							<li><a class="dropdown-item text-dark" href="javascript:listFromRecordsInScreen(document.getElementById('dropdownMenuButton1'), 20)">20</a></li>
							<li><a class="dropdown-item text-dark" href="javascript:listFromRecordsInScreen(document.getElementById('dropdownMenuButton1'), 50)">50</a></li>
							<li><a class="dropdown-item text-dark" href="javascript:listFromRecordsInScreen(document.getElementById('dropdownMenuButton1'), 100)">100</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!--/* 
		### search-page script
	 */-->
	 
	<!--/* javaScript for inline update button. inline update buttonを配置するならこれも併せて配置。通常ページの一番下に配置。  */-->
	<div th:fragment="scriptForThSortable(options)" th:remove="tag">
		<script>
		function list(sortItem, direction) {
			document.getElementById("sortItem").value = sortItem;
			document.getElementById("direction").value = direction;
			document.getElementById("action").value = "searchAgain";
			document.searchForm.submit();
		}
		</script>	
	</div>
	
	<div th:fragment="scriptForRecordsInScreen(options)" th:remove="tag">
		<script>
		function listFromRecordsInScreen(button, recordsInScreen) {
			document.getElementById("recordsInScreen").value = recordsInScreen;
			button.form.requestSubmit(document.getElementById('dropdownMenuButton1')); 
		}
		</script>
	</div>

	<div th:fragment="scriptForPagenation(options)" th:remove="tag">
		<script>
		function listFromPage(page) {
			document.getElementById("page").value = page;
			document.getElementById("action").value = "searchAgain";
			document.searchForm.submit();
		}
		</script>
	</div>
	
	<!-- /* 3つのscriptをまとめたもの。htmlパーツ側も結局セットにしたのでscript側もセットで使用することとする */ -->
	<div th:fragment="scriptForSortPagingAndRecordsInScreen(options)" th:remove="tag">
		<div th:replace="~{ :: scriptForThSortable('')}"></div>
		<div th:replace="~{ :: scriptForRecordsInScreen('')}"></div>
		<div th:replace="~{ :: scriptForPagenation('')}"></div>
	</div>



	<!--/* 
		###
		### list-page components.
		###
	 */-->

	<!--/* 
		### search-page script
	 */-->

	<!--/* 
		### table header(th).
	 */-->

	<!--/* sort不可能なth。text-alignはcenter固定。formは引数に与えていないが外でth:withでformという名前に設定しておく必要あり */-->
	<div th:fragment="thText(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: thCustomizable(${itemPropertyPath}, 'center', ${options})}"></div>
	</div>
	
	<!--/* sort可能なth。text-alignはcenter固定。formは引数に与えていないが外でth:withでformという名前に設定しておく必要あり */-->
	<div th:fragment="thSortable(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: thCustomizable(${itemPropertyPath}, 'center', ${options + ',thSortable'})}"></div>
	</div>
	
	<!--/* カスタマイズ可能なsort可能なth。formは引数に与えていないが外でth:withでformという名前に設定しておく必要あり */-->
	<div th:fragment="thCustomizable(itemPropertyPath, position, options)" th:remove="tag">
		<th:block th:with="recordName=${itemPropertyPath.contains('.') ? rootRecordName + '.' + itemPropertyPath.substring(0, itemPropertyPath.lastIndexOf('.')) : rootRecordName},
				fieldName=${itemPropertyPath.contains('.') ? itemPropertyPath.substring(itemPropertyPath.lastIndexOf('.') + 1) : itemPropertyPath}">
			<th:block th:with="id=${recordName + '.' + fieldName},labelFieldName=${listForm.__${rootRecordName}__.getItem('__${itemPropertyPath}__').getItemNameKey('__${rootRecordName}__')}">
				<th:block th:if="${@optUtil.hasKey(options, 'thSortable')}">
					<th scope="col" th:class="'text-' + ${position == 'left' ? 'start' : (position == 'right' ? 'end' : position)} + ' text-white bg-color-tbl-header'"
							th:classappend="${bsBgGradient == null || !bsBgGradient ? '' : 'bg-gradient'}" 
							style="cursor: pointer" th:text="${@msgUtil.getValue(#locale, labelFieldName)}" 
							th:data-item="${itemPropertyPath}" th:data-direction="${form.nextDirection('__${itemPropertyPath}__')}"
							onClick="list(this.dataset.item, this.dataset.direction);"></th>
		 		</th:block>
		 		<th:block th:if="${!@optUtil.hasKey(options, 'thSortable')}">
					<th scope="col" th:class="'text-' + ${position == 'left' ? 'start' : (position == 'right' ? 'end' : position)} + ' text-white bg-color-tbl-header'"
							th:classappend="${bsBgGradient == null || !bsBgGradient ? '' : 'bg-gradient'}" 
							th:text="${@msgUtil.getValue(#locale, labelFieldName)}"></th>
		 		</th:block>
	 	</th:block>
	</div>
	
	<!--/* th with label string */-->
	<div th:fragment="thFreeText(label, options)" th:remove="tag">
		<th scope="col" class="text-center text-white bg-color-tbl-header"  
				th:classappend="${bsBgGradient == null || !bsBgGradient ? '' : 'bg-gradient'}" 
				th:text="${@msgUtil.getValue(#locale, label)}"></th>
	</div>
	
	<!-- update button -->
	<div th:fragment="thUpdateButton(options)" th:remove="tag">
		<div th:replace="~{ :: thFreeText('jp.ecuacion.splib.web.common.button.update', ${options})}"></div>
	</div>
	
	<!-- delete button -->
	<div th:fragment="thDeleteButton(options)" th:remove="tag">
		<div th:replace="~{ :: thFreeText('jp.ecuacion.splib.web.common.button.delete', ${options})}"></div>
	</div>
	
	<!-- switch user button -->
	<div th:fragment="thSwitchUserButton(options)" th:remove="tag">
		<div th:replace="~{ :: thFreeText('jp.ecuacion.splib.web.switchUser.switchButton', ${options})}"></div>
	</div>

	<!--/* 
		### The followings are td components.
	 */-->

	<!--/* td readOnly customizable */-->
	<!--/* context options: (temporary)
			- th:with="deleted=true"	adds a deleted line effect.
	*/-->
	<div th:fragment="tdReadOnlyCustomizable(value, position, options)" th:remove="tag">
		<td th:class="'align-middle fs-6 text-' + ${position == 'left' ? 'start' : (position == 'right' ? 'end' : position)}"
				th:th:rowspan="${@optUtil.getValueOrElse(options, 'rows', '1')}" th:colspan="${@optUtil.getValueOrElse(options, 'cols', '1')}"
				th:classappend="${(deleted != null && deleted) || @optUtil.hasKey(options, 'deleted')} ? 'text-deleted' : 'text-dark'">
			<th:block th:if="${@optUtil.hasKey(options, 'linkUrl')}">
				<a th:href="${@optUtil.getValue(options, 'linkUrl')}" target="_blank">[[${value}]]</a>
			</th:block>
			<th:block th:if="${@optUtil.hasKey(options, 'linkUrl') == false}">
				[[${value}]]
			</th:block>
		</td>
	</div>
	
	<!--/* td readOnly text */-->
	<div th:fragment="tdReadOnlyText(itemPropertyPath, options)" th:remove="tag">
		<th:block th:with="value=${rec.getValue(itemPropertyPath)}">
			<div th:replace="~{ :: tdReadOnlyCustomizable(${value}, 'left', ${options})}"></div>
		</th:block>
	</div>
	
	<!--/* td readOnly number */-->
	<div th:fragment="tdReadOnlyNumber(itemPropertyPath, options)" th:remove="tag">
		<th:block th:with="value=${rec.getValue(itemPropertyPath)},
				needsCommas=*{needsCommas('__${rootRecordName}__', '__${itemPropertyPath}__')}">
			<div th:replace="~{ :: tdReadOnlyCustomizable(${(needsCommas ? #numbers.formatDecimal(value, 1, 'COMMA', 0, 'POINT')
					: value)}, 'right', ${options})}"></div>
		</th:block>
	</div>
	
	<!--/* td readOnly fixed length */-->
	<div th:fragment="tdReadOnlyFixedLength(itemPropertyPath, options)" th:remove="tag">
		<th:block th:with="value=${rec.getValue(itemPropertyPath)}">
			<div th:replace="~{ :: tdReadOnlyCustomizable(${value}, 'center', ${options})}"></div>
		</th:block>
	</div>
	
	<!--/* td readOnly free text */-->
	<div th:fragment="tdReadOnlyFreeText(value, options)" th:remove="tag">
		<div th:replace="~{ :: tdReadOnlyCustomizable(${value}, 'left', ${options})}"></div>
	</div>
	
	<!--/* td readOnly free fixed length */-->
	<div th:fragment="tdReadOnlyFreeFixedLength(value, options)" th:remove="tag">
		<div th:replace="~{ :: tdReadOnlyCustomizable(${value}, 'center', ${options})}"></div>
	</div>
	
	<!--/* td readOnly enum text */-->
	<div th:fragment="tdReadOnlyEnumText(itemPropertyPath, options)" th:remove="tag">
		<th:block th:with="value=${rec.__${@strUtil.getMethodName(itemPropertyPath)}__Name(#locale)}">
			<div th:replace="~{ :: tdReadOnlyCustomizable(${value}, 'left', ${options})}"></div>
		</th:block>
	</div>
	
	<!--/* td readOnly checkbox */-->
	<div th:fragment="tdReadOnlyCheckbox(itemPropertyPath, options)" th:remove="tag">
		<td class="align-middle text-center" th:th:rowspan="${@optUtil.getValueOrElse(options, 'rows', '1')}" th:colspan="${@optUtil.getValueOrElse(options, 'cols', '1')}">
			<input class="form-check-input align-bottom mb-1 " type="checkbox" th:checked="*{__${itemPropertyPath}__}" disabled>
		</td>
	</div>

	<!--/* internalTdInputCommon */-->
	<div th:fragment="internalTdInputInsideTdCommon(itemPropertyPath, allInputContents, options)" th:remove="tag">
		<th:block th:with="index=${recStat.index},isReadOnly=${@optUtil.hasKey(options, 'readOnly')}">
			<th:block th:with="inputId='recList' + ${index} + '.' + ${itemPropertyPath},
					inputName='recList[' + ${index} + '].' + ${itemPropertyPath},
					inputValue=${recList[__${index}__].__${itemPropertyPath}__},
					needsCommas=*{needsCommas('__${rootRecordName}__', '__${itemPropertyPath}__')}">

				<div th:replace="${allInputContents}"></div>

			</th:block>
		</th:block>
	</div>

	<!--/* internalTdInputCommon */-->
	<div th:fragment="internalTdInputCommon(itemPropertyPath, allInputContents, options)" th:remove="tag">
		<td class="align-middle text-center" th:th:rowspan="${@optUtil.getValueOrElse(options, 'rows', '1')}" th:th:colspan="${@optUtil.getValueOrElse(options, 'cols', '1')}">
			<div th:replace="~{ :: internalTdInputInsideTdCommon(${itemPropertyPath}, ${allInputContents}, ${options})}"></div>
		</td>
	</div>

	<!--/* inline input text */-->
	<div th:fragment="tdInputText(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalTdInputCommon(${itemPropertyPath}, ~{ :: internalAllHtmlInputComponent('left')}, ${options})}"></div>
	</div>
	
	<!--/* inline input number */-->
	<div th:fragment="tdInputNumber(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalTdInputCommon(${itemPropertyPath}, ~{ :: internalAllHtmlInputComponent('right')}, ${options})}"></div>
	</div>
	
	<!--/* inline input hidden */-->
	<div th:fragment="tdInputHidden(itemPropertyPath, options)" th:remove="tag">
		<th:block th:with="type=hidden">
			<div th:replace="~{ :: internalTdInputInsideTdCommon(${itemPropertyPath}, ~{ :: internalAllHtmlInputComponent(null)}, ${options})}"></div>
		</th:block>
	</div>

	<!--/* inline input checkbox */-->
	<div th:fragment="tdInputCheckbox(itemPropertyPath, options)" th:remove="tag">
		<div th:replace="~{ :: internalTdInputCommon(${itemPropertyPath}, ~{ :: internalAllHtmlCheckboxComponent(false)}, ${options})}"></div>
	</div>

	<!--/* showInsertFormButton */-->
	<div th:fragment="showInsertFormButton(options)" th:remove="tag">
		<div th:replace="~{ :: submitButton('showInsertForm', 'jp.ecuacion.splib.web.common.button.insert', ${options})}"></div>
	</div>

	<!--/* tdSubmitButton */-->
	<div th:fragment="tdSubmitButton(name, label, options)" th:remove="tag">
		<td class="text-center p-1 align-middle" height="10px" th:rowspan="${@optUtil.getValueOrElse(options, 'rows', '1')}" th:colspan="${@optUtil.getValueOrElse(options, 'cols', '1')}">
	 		<div th:replace="~{ :: submitButton(${name}, ${label}, 'classappend=btn-sm,' + ${options})}">
	 		</div>
		</td>
	</div>
	
	<!--/* tdSubmitButtonWithIds */-->
	<div th:fragment="tdSubmitButtonWithIds(name, label, onClickFunctionName, options)" th:remove="tag">
		<div th:replace="~{ :: tdSubmitButton(${name}, ${@msgUtil.getValue(#locale, @optUtil.getValueOrElse(options, 'text', label))},
					'id=' + ${name} + '_' + *{ids} + ',event=click|' + ${onClickFunctionName} + ',' 
					+ ',attr=data-ids|' + *{ids} + ',attr=data-versions|' + *{optimisticLockVersions} + ',' + ${options})}">
		</div>
	</div>

	<!--/* inline update button */-->
	<div th:fragment="tdUpdateButton(options)" th:remove="tag">
		<div th:replace="~{ :: tdSubmitButtonWithIds('showUpdateForm', 'jp.ecuacion.splib.web.common.button.update', 'update', ${options})}"></div>
	</div>
	
	<!--/* inline delete button */-->
	<div th:fragment="tdDeleteButton(recordValueDisplayedOnDelete, options)" th:remove="tag">
		<div th:replace="~{ :: tdSubmitButtonWithIds('delete', 'jp.ecuacion.splib.web.common.button.delete', 'del', 
				'classappend=btn-color-btn-danger,attr=data-item|' + ${recordValueDisplayedOnDelete} + ',' + ${options})}"></div>
	</div>
	
	<!--/* inline switch user button */-->
	<div th:fragment="tdSwitchUserButton(username, options)" th:remove="tag">
		<div th:replace="~{ :: tdSubmitButtonWithIds('switchUser', 'jp.ecuacion.splib.web.switchUser.switchButton', 'switchUser', 
				'attr=data-username|' + ${username} + ',' + ${options})}"></div>
	</div>
	
	<!--/* javaScript for inline update button. Use with tdUpdateButton. Put it at "bottom-space" part in a page template.  */-->
	<div th:fragment="scriptFortdUpdateButton(rootRecordName, options)" th:remove="tag">
		<script th:with="ids=${rootRecordName + '.ids'},versions=${rootRecordName + '.optimisticLockVersions'}">
		function update(event, button) {
			document.forms[button.form.name].elements['[[${ids}]]'].value = button.dataset.ids;
			document.forms[button.form.name].elements['[[${versions}]]'].value = button.dataset.versions;
		}
		</script>
	</div>

	<!--/* javaScript for inline delete button.  Use with tdDeleteButton. Put it at "bottom-space" part in a page template.  */-->
	<div th:fragment="scriptFortdDeleteButton(rootRecordName, itemDisplayedOnDelete, options)" th:remove="tag">
		<script th:with="ids=${rootRecordName + '.ids'},versions=${rootRecordName + '.optimisticLockVersions'}">
		function del(event, button) {
			var message = "[[${@compUtil.getDeleteConfirmMessage(rootRecordName, itemDisplayedOnDelete)}]]" + " " + button.dataset.item;
			var bl = confirm(message);

			if (bl) {
				document.forms[button.form.name].elements['[[${ids}]]'].value = button.dataset.ids;
				document.forms[button.form.name].elements['[[${versions}]]'].value = button.dataset.versions;

			} else {
				event.preventDefault();
			}
		}
		</script>
	</div>

	<!--/* javaScript for inline switch user. Use with tdSwitchUserButton. Put it at "bottom-space" part in a page template.  */-->
	<div th:fragment="scriptFortdSwitchUserButton(options)" th:remove="tag">
		<form id="switchUserForm" method="GET" th:action="@{/admin/switchUser}">
			<input type="hidden" id="switchUser.username" name="switchUser.username">
		</form>
		<script>
		function switchUser(event, button) {
			// default submit not needed.
			event.preventDefault();

			document.getElementById("switchUser.username").value = button.dataset.username;
			document.getElementById("switchUserForm").submit();
		}
		</script>
	</div>

</body>
</html>
